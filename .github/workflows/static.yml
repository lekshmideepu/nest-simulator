name: My Workflow

# Controls when the action will run. 
on: 
  push:
    branches:
      - githubaction-ci-2
      #- 'master/*'
env:
   message: 'world'
# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  my_build:
    runs-on: ubuntu-latest
    steps:
       # Steps represent a sequence of tasks that will be executed as part of the job
      - name: Checkout repo content 
        #uses: actions/checkout@v2 # checkout the repository content to github runner.
        uses: actions/checkout@master
        
      - name: Say Something
        run: |
           echo "Hello ${message}"
           echo "Again Welcome"
           echo $PATH
           echo $PWD
           ls /home/runner/work/nest-simulator/nest-simulator
           ls /home/runner/work/nest-simulator/nest-simulator/extras/staticbuild.sh
           ls /home/runner/work/nest-simulator/nest-simulator/extras
        shell: bash
      - name: Set up Python 3.x
        uses: actions/setup-python@v2
        with:
          python-version: 3.9
        run: echo "Welcome to the NEST static analysis build"
        env:
          key: xNEST_BUILD_TYPE= STATIC_CODE_ANALYSIS
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip setuptools
          python -m pip install scipy junitparser numpy nose cython matplotlib terminaltables
          pip list
          g++ --version
          set -o pipefail
          chmod +x extras/staticbuild.sh
          ./extras/staticbuild.sh
        
  my_job:
    needs: [my_build]
    runs-on: ubuntu-latest
    steps:
      - name: Set up Python 3.x
        uses: actions/setup-python@v2
        with:
        # Semantic version range syntax or exact version of a Python version
          python-version: 3.8 #Install the python needed ,'3.x' 0r 3.8
        # Optional - x64 or x86 architecture, defaults to x64
          #architecture: 'x64'
      - name: Initialisation
        run: echo "Welcome to the NEST static analysis build"
        env:
          key: xNEST_BUILD_TYPE= STATIC_CODE_ANALYSIS
      #- name: execute py script # run the run.py to get the latest data  
        #run: |
          #python run.py
        #env: 
          #xNEST_BUILD_TYPE= STATIC_CODE_ANALYSIS
        #run: python -c "import sys; print(sys.version)"
        
      - name: Install dependencies
        run: |
           python -m pip install --upgrade pip setuptools
           python -m pip install scipy junitparser numpy nose cython matplotlib terminaltables
           pip list
           g++ --version
           #chmod +x extras/travis_build.sh
           set -o pipefail
           #./extras/travis_build.sh 2>&1 | tee travis_build.sh.log
           #echo "change permission"
           chmod +x /home/runner/work/nest-simulator/nest-simulator/extras/staticbuild.sh
           #./home/runner/work/nest-simulator/nest-simulator/extras/staticbuild.sh
           ./extras/staticbuild.sh
        #working-directory: /home/runner/work/nest-simulator/nest-simulator/extras
        shell: bash  

#jobs:
  #build:
    #strategy:
      #matrix:
        #compiler: [gcc-6, gcc-7]
    #env:
      #CC: ${{ matrix.compiler }}
    #steps:
      #.....
